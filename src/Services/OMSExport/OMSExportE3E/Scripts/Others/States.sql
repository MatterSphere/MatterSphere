-- * STATES *
-- USE THIS SCRIPT TO CREATE THE STATES IN MATTERSPHERE
-- ENSURE THAT THE COUNTRY SCRIPT HAS BEEN RUN ALREADY (!)

-- RUN ON THE MATTERSPHERE DATABASE




-- 1) CREATE 'STATES' CODELOOKUP GROUP
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = 'OMS' AND CDCODE = 'STATES' AND CDGROUP = 1 ) 				
INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC , CDGROUP ) VALUES ( 'OMS' , 'STATES' , 'States' , 1 )				
	

-- 2) CREATE THE 'STATES' SUBFOLDER CODELOOKUP GROUPS
-- US	United States of America
IF NOT EXISTS (SELECT * FROM DBCODELOOKUP WHERE CDTYPE = 'STATES' AND CDCODE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US')) 
	INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC , CDGROUP ) SELECT 'STATES' , CTRYID , 'United States of America' , 1 FROM DBCOUNTRY WHERE CTRYCODE = 'US'
-- CA	Canada					
IF NOT EXISTS (SELECT * FROM DBCODELOOKUP WHERE CDTYPE = 'STATES' AND CDCODE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA')) 
	INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC , CDGROUP ) SELECT 'STATES' , CTRYID , 'Canada' , 1 FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
-- AU	Australia					
IF NOT EXISTS (SELECT * FROM DBCODELOOKUP WHERE CDTYPE = 'STATES' AND CDCODE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU')) 
	INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC , CDGROUP ) SELECT 'STATES' , CTRYID , 'Australia' , 1 FROM DBCOUNTRY WHERE CTRYCODE = 'AU'


-- 3) CREATE STATE ENTRIES IN CORRECT STATE SUBFOLDERS
-- US	United States of America
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'AL') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'AL','AL' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'AK') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'AK','AK' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'AS') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'AS','AS' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'AR') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'AR','AR' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'CA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'CA','CA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'CO') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'CO','CO' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'CT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'CT','CT' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'DE') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'DE','DE' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'FL') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'FL','FL' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'DC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'DC','DC' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'HI') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'HI','HI' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'ID') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'ID','ID' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'GU') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'GU','GU' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'IN') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'IN','IN' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'IA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'IA','IA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'KS') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'KS','KS' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'KY') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'KY','KY' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'LA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'LA','LA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'ME') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'ME','ME' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MD') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MD','MD' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MA','MA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MI') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MI','MI' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MN') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MN','MN' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MS') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MS','MS' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MO') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MO','MO' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MT','MT' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NE') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NE','NE' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NV') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NV','NV' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NH') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NH','NH' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NJ') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NJ','NJ' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NM') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NM','NM' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NY') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NY','NY' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'NC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NC','NC' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'ND') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'ND','ND' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'OH') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'OH','OH' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'OK') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'OK','OK' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'OR') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'OR','OR' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'MP') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MP','MP' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'RI') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'RI','RI' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'SC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'SC','SC' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'SD') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'SD','SD' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'TN') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'TN','TN' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'PR') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'PR','PR' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'UT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'UT','UT' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'VT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'VT','VT' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'VA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'VA','VA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'WA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'WA','WA' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'WV') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'WV','WV' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'VI') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'VI','VI' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'US') AND CDCODE = 'WY') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'WY','WY' FROM DBCOUNTRY WHERE CTRYCODE = 'US'
-- CA	Canada
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'ON') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'ON','ON' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'QC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'QC','QC' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'NS') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NS','NS' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'NB') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NB','NB' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'MB') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'MB','MB' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'BC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'BC','BC' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'PE') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'PE','PE' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'SK') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'SK','SK' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'AB') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'AB','AB' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'CA') AND CDCODE = 'NL') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NL','NL' FROM DBCOUNTRY WHERE CTRYCODE = 'CA'
-- AU	Australia
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'ACT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'ACT','ACT' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'JBT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'JBT','JBT' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'NSW') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NSW','NSW' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'NT') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'NT','NT' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'QLD') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'QLD','QLD' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'SA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'SA','SA' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'TAS') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'TAS','TAS' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'VIC') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'VIC','VIC' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
IF NOT EXISTS ( SELECT * FROM DBCODELOOKUP WHERE CDTYPE = ( SELECT CONVERT ( NVARCHAR ( 15 ) , CTRYID ) FROM DBCOUNTRY WHERE CTRYCODE = 'AU') AND CDCODE = 'WA') INSERT INTO DBCODELOOKUP ( CDTYPE , CDCODE , CDDESC ) SELECT CTRYID , 'WA','WA' FROM DBCOUNTRY WHERE CTRYCODE = 'AU'
